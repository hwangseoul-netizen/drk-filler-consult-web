<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr.K Aesthetic - Private Consultation</title>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        :root {
            --primary: #1B2A41;   /* ë¯¸ë“œë‚˜ì‡ ë„¤ì´ë¹„ */
            --secondary: #D4A5A5; /* í†¤ë‹¤ìš´ ë¡œì¦ˆ */
            --bg: #F8F9FA;
            --card: #FFFFFF;
            --text-main: #1F1F1F;
            --text-sub: #707070;
            --border: #EAEAEA;
            --input-bg: #FAFAFA;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        
        body { background-color: var(--bg); color: var(--text-main); -webkit-font-smoothing: antialiased; }

        /* ê³µí†µ ë ˆì´ì•„ì›ƒ */
        .app-container { max-width: 600px; margin: 0 auto; background: var(--bg); min-height: 100vh; position: relative; }
        .container { padding: 20px; padding-bottom: 80px; }

        /* í—¤ë” */
        .header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 20px; background: var(--card);
            border-bottom: 1px solid var(--border);
            position: sticky; top: 0; z-index: 100;
        }
        .header-title { font-size: 20px; font-weight: 800; color: var(--primary); letter-spacing: -0.5px; }
        .header-subtitle { font-size: 12px; color: var(--text-sub); margin-top: 2px; }
        
        .mode-switch {
            padding: 6px 12px; border-radius: 20px; background: #F0F0F5; border: none; cursor: pointer;
            font-size: 12px; font-weight: 600; color: #888; transition: 0.3s;
        }
        .mode-switch.active { background: var(--primary); color: #FFF; }

        /* íˆì–´ë¡œ ì„¹ì…˜ */
        .hero-section { margin: 24px 0; }
        .hero-main { font-size: 24px; font-weight: 700; color: var(--text-main); line-height: 1.4; margin-bottom: 8px; }
        .highlight { color: var(--secondary); }
        .hero-sub { font-size: 14px; color: var(--text-sub); line-height: 1.6; }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: var(--card); border-radius: 20px; padding: 24px; margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05); border: 1px solid var(--border);
        }
        .card-header { display: flex; align-items: center; margin-bottom: 16px; }
        .step-badge {
            font-size: 10px; font-weight: 800; color: var(--secondary); background: #FFF0F0;
            padding: 4px 8px; border-radius: 6px; margin-right: 8px;
        }
        .card-title { font-size: 18px; font-weight: 700; color: var(--text-main); }

        /* ì¸í’‹ & ë²„íŠ¼ */
        input, textarea {
            width: 100%; background: var(--input-bg); border: 1px solid var(--border);
            border-radius: 12px; padding: 14px; font-size: 15px; color: var(--text-main);
            outline: none; transition: 0.2s; margin-bottom: 12px;
        }
        input:focus, textarea:focus { border-color: var(--secondary); }
        textarea { resize: none; height: 100px; }
        .label { font-size: 14px; font-weight: 600; margin: 8px 0; display: block; }
        .helper { font-size: 12px; color: #999; margin-bottom: 8px; display: block; }

        /* ì¹© & íƒ­ */
        .tab-scroll { display: flex; overflow-x: auto; gap: 10px; padding-bottom: 10px; margin-bottom: 10px; scrollbar-width: none; }
        .tab-scroll::-webkit-scrollbar { display: none; }
        .tab-item {
            white-space: nowrap; padding: 8px 16px; border-radius: 24px; background: #F0F2F5;
            color: #666; font-size: 14px; font-weight: 500; cursor: pointer; border: none;
        }
        .tab-item.selected { background: var(--primary); color: #FFF; font-weight: 700; }

        .chip-grid { display: flex; flex-wrap: wrap; gap: 8px; }
        .chip {
            padding: 8px 14px; border-radius: 8px; border: 1px solid var(--border); background: #FFF;
            font-size: 14px; color: #555; cursor: pointer; transition: 0.2s;
        }
        .chip:hover { background: #FAFAFA; }
        .chip.selected { border-color: var(--secondary); background: #FFF5F8; color: #D45D79; font-weight: 600; }

        /* ë ˆë²¨ ë²„íŠ¼ */
        .level-row { display: flex; gap: 8px; margin-bottom: 20px; }
        .level-btn {
            flex: 1; background: #FFF; border: 1px solid var(--border); border-radius: 12px;
            padding: 16px 4px; text-align: center; cursor: pointer;
        }
        .level-btn.selected { border-color: var(--secondary); background: #FFF5F8; }
        .level-title { font-size: 14px; font-weight: 700; margin-bottom: 4px; }
        .level-btn.selected .level-title { color: #D45D79; }
        .level-desc { font-size: 11px; color: #999; }

        /* ë©”ì¸ ë²„íŠ¼ */
        .main-btn {
            width: 100%; background: var(--primary); color: #FFF; font-size: 16px; font-weight: 700;
            padding: 18px; border-radius: 14px; border: none; cursor: pointer; margin-top: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: 0.2s;
        }
        .main-btn:active { transform: scale(0.98); }
        .submit-msg { margin-top: 12px; font-size: 14px; color: #2ECC71; text-align: center; font-weight: 600; }

        /* ë‹¥í„° ëª¨ë“œ ë¦¬ìŠ¤íŠ¸ */
        .case-item {
            background: #FFF; border-radius: 12px; padding: 16px; margin-bottom: 10px; border: 1px solid #EEE; cursor: pointer;
        }
        .case-item.new { border-color: var(--secondary); background: #FFFBFB; }
        .case-item.selected { border: 2px solid var(--primary); }
        .case-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .case-part { font-size: 16px; font-weight: 700; color: #333; }
        .badge { padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 700; }
        .badge.new { background: #FFE5EC; color: #FF4081; }
        .badge.done { background: #E8F5E9; color: #2E7D32; }
        
        /* ì±„íŒ… ë§í’ì„  */
        .chat-box { background: #F8F9FA; border-radius: 16px; padding: 16px; min-height: 150px; margin-bottom: 16px; }
        .bubble { max-width: 80%; padding: 12px; border-radius: 16px; margin-bottom: 10px; font-size: 14px; line-height: 1.5; }
        .bubble.user { background: #FFF; align-self: flex-start; border: 1px solid var(--border); border-top-left-radius: 0; float: left; clear: both; }
        .bubble.doctor { background: var(--primary); color: #FFF; align-self: flex-end; border-top-right-radius: 0; float: right; clear: both; }
        .clearfix::after { content: ""; display: table; clear: both; }

    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        /* ë°ì´í„° ì •ì˜ */
        const CATEGORIES = [
            { title: "ì–¼êµ´", items: ["ì½”í•„ëŸ¬","ì½§ëŒ€","ì½”ë","ì´ë§ˆ","ë¯¸ê°„","ëˆˆë°‘","ì•ê´‘ëŒ€","ì˜†ë³¼","íŒ”ìì£¼ë¦„","ì…ê°€ì£¼ë¦„","ì…ê¼¬ë¦¬","í„±ë","ë¬´í„±","í„±ë¼ì¸","ê´€ìë†€ì´","ì…ìˆ ","ì–¼êµ´ì¶•ì†Œ","ì¤‘ì•ˆë©´"] },
            { title: "ë‘ìƒ", items: ["ë‘ìƒ","ë’¤í†µìˆ˜","ì •ìˆ˜ë¦¬","í—¤ì–´ë¼ì¸"] },
            { title: "ì–´ê¹¨/ê°€ìŠ´", items: ["ì–´ê¹¨","ì‡„ê³¨","ê°€ìŠ´ë³¼ë¥¨","ê°€ìŠ´ê³¨"] },
            { title: "ê³¨ë°˜/í™", items: ["ê³¨ë°˜","í™ë”¥","í™ì—…","í—ˆë¦¬ë¼ì¸"] },
            { title: "ë‹¤ë¦¬", items: ["í—ˆë²…ì§€","ë¬´ë¦","ì¢…ì•„ë¦¬","ë°œëª©"] }
        ];
        const allParts = CATEGORIES.flatMap(g => g.items);
        const CHANGE_LEVELS = [
            { key: "light", label: "ìì—°ìŠ¤ëŸ½ê²Œ", desc: "ë‚˜ë§Œ ì•„ëŠ” ë¯¸ì„¸ êµì •" },
            { key: "standard", label: "í™•ì‹¤í•˜ê²Œ", desc: "ì‚¬ì§„ì—ì„œ í‹°ë‚˜ëŠ” ë³€í™”" },
            { key: "full", label: "í™”ë ¤í•˜ê²Œ", desc: "ì´ë¯¸ì§€ ëŒ€ë³€ì‹ " }
        ];

        /* ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸ */
        function App() {
            const [adminMode, setAdminMode] = useState(false);
            
            // ì‚¬ìš©ì State
            const [selectedGroup, setSelectedGroup] = useState(CATEGORIES[0].title);
            const [selectedPart, setSelectedPart] = useState(null);
            const [searchKeyword, setSearchKeyword] = useState("");
            const [concern, setConcern] = useState("");
            const [desired, setDesired] = useState("");
            const [refNote, setRefNote] = useState("");
            const [level, setLevel] = useState(null);
            const [msg, setMsg] = useState("");

            // ë‹¥í„° State
            const [submissions, setSubmissions] = useState([]);
            const [selectedCaseId, setSelectedCaseId] = useState(null);
            const [doctorDraft, setDoctorDraft] = useState("");

            const currentGroup = CATEGORIES.find(g => g.title === selectedGroup);
            const searchMatches = searchKeyword.trim().length > 0 
                ? allParts.filter(p => p.includes(searchKeyword.trim())) : [];
            const selectedCase = submissions.find(c => c.id === selectedCaseId);

            // ìƒë‹´ ì ‘ìˆ˜ í•¸ë“¤ëŸ¬
            const handleSubmit = () => {
                setMsg("");
                if(!selectedPart) { setMsg("â— ì‹œìˆ  ë¶€ìœ„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
                if(!concern.trim()) { setMsg("â— ê³ ë¯¼ ë‚´ìš©ì„ ì ì–´ì£¼ì„¸ìš”."); return; }

                const newCase = {
                    id: Date.now().toString(),
                    createdAt: new Date(),
                    part: selectedPart,
                    group: selectedGroup,
                    concern, desired, refNote, level,
                    status: "new",
                    messages: [{ id: "m_"+Date.now(), from: "user", text: `[ë¬¸ì˜] ${selectedPart}\nê³ ë¯¼: ${concern}` }]
                };
                setSubmissions([newCase, ...submissions]);
                // ì´ˆê¸°í™”
                setConcern(""); setDesired(""); setRefNote(""); setLevel(null);
                setMsg("âœ… ìƒë‹´ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¥í„°ì¼€ì´ê°€ ë¶„ì„í•´ë“œë¦´ê²Œìš”.");
            };

            // ë‹¥í„° ë‹µë³€ í•¸ë“¤ëŸ¬
            const handleDoctorReply = () => {
                if(!selectedCase || !doctorDraft.trim()) return;
                const newMsg = { id: "d_"+Date.now(), from: "doctor", text: doctorDraft };
                
                setSubmissions(prev => prev.map(c => 
                    c.id === selectedCase.id 
                    ? { ...c, status: "answered", messages: [...c.messages, newMsg] } 
                    : c
                ));
                setDoctorDraft("");
            };

            return (
                <div className="app-container">
                    <header className="header">
                        <div>
                            <div className="header-title">Dr.K Aesthetic</div>
                            <div className="header-subtitle">Personal Consultation</div>
                        </div>
                        <button 
                            className={`mode-switch ${adminMode ? 'active' : ''}`} 
                            onClick={() => setAdminMode(!adminMode)}
                        >
                            {adminMode ? "Doctor" : "Client"}
                        </button>
                    </header>

                    <div className="container">
                        {!adminMode ? (
                            // === ì‚¬ìš©ì ëª¨ë“œ ===
                            <>
                                <div className="hero-section">
                                    <div className="hero-main">
                                        ë‚˜ë§Œì˜ ë¼ì¸ì„ ì°¾ëŠ”<br/>
                                        <span className="highlight">ë‹¥í„°ì¼€ì´</span> í”„ë¼ì´ë¹— ìƒë‹´
                                    </div>
                                    <div className="hero-sub">
                                        ì „ì‹  í•„ëŸ¬ ì•„í‹°ìŠ¤íŠ¸ê°€ ë‹¹ì‹ ì˜ ê³ ë¯¼ì„ ë¶„ì„í•©ë‹ˆë‹¤.<br/>
                                        ë¹„ëŒ€ë©´ìœ¼ë¡œ í¸ì•ˆí•˜ê²Œ ìƒë‹´ë°›ì•„ë³´ì„¸ìš”.
                                    </div>
                                </div>

                                {/* Step 1 */}
                                <div className="card">
                                    <div className="card-header">
                                        <span className="step-badge">STEP 1</span>
                                        <span className="card-title">ì–´ë””ê°€ ê³ ë¯¼ì´ì„¸ìš”?</span>
                                    </div>
                                    <input 
                                        type="text" placeholder="ğŸ” ì˜ˆ: í™ë”¥, ì§ê°ì–´ê¹¨, íŒ”ìì£¼ë¦„..." 
                                        value={searchKeyword} onChange={e => setSearchKeyword(e.target.value)}
                                    />
                                    
                                    {searchMatches.length > 0 && (
                                        <div className="chip-grid" style={{marginBottom: '15px'}}>
                                            {searchMatches.slice(0,5).map(p => (
                                                <div key={p} className={`chip ${selectedPart === p ? 'selected' : ''}`}
                                                    onClick={() => { setSelectedPart(p); setSearchKeyword(""); }}
                                                >
                                                    {p}
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    <div className="tab-scroll">
                                        {CATEGORIES.map(g => (
                                            <button key={g.title} 
                                                className={`tab-item ${selectedGroup === g.title ? 'selected' : ''}`}
                                                onClick={() => { setSelectedGroup(g.title); setSelectedPart(null); }}
                                            >
                                                {g.title}
                                            </button>
                                        ))}
                                    </div>
                                    
                                    <div className="chip-grid">
                                        {currentGroup.items.map(item => (
                                            <div key={item} 
                                                className={`chip ${selectedPart === item ? 'selected' : ''}`}
                                                onClick={() => setSelectedPart(item)}
                                            >
                                                {item}
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {/* Step 2 */}
                                <div className="card">
                                    <div className="card-header">
                                        <span className="step-badge">STEP 2</span>
                                        <span className="card-title">ë””í…Œì¼ ì‘ì„±</span>
                                    </div>
                                    <label className="label">í˜„ì¬ ê³ ë¯¼</label>
                                    <textarea placeholder="ì˜ˆ: ê³¨ë°˜ ë¼ì¸ì´ ìš¸í‰ë¶ˆí‰í•´ìš”." value={concern} onChange={e => setConcern(e.target.value)}></textarea>
                                    
                                    <label className="label">ì›í•˜ëŠ” ëŠë‚Œ</label>
                                    <textarea placeholder="ì˜ˆ: ìì—°ìŠ¤ëŸ½ê³  ë§¤ë„ëŸ½ê²Œ..." style={{height:'60px'}} value={desired} onChange={e => setDesired(e.target.value)}></textarea>
                                </div>

                                {/* Step 3 */}
                                <div className="card">
                                    <div className="card-header">
                                        <span className="step-badge">STEP 3</span>
                                        <span className="card-title">ê°•ë„ ì„ íƒ</span>
                                    </div>
                                    <div className="level-row">
                                        {CHANGE_LEVELS.map(lv => (
                                            <div key={lv.key} 
                                                className={`level-btn ${level === lv.key ? 'selected' : ''}`}
                                                onClick={() => setLevel(lv.key)}
                                            >
                                                <div className="level-title">{lv.label}</div>
                                                <div className="level-desc">{lv.desc}</div>
                                            </div>
                                        ))}
                                    </div>
                                    <label className="label">ì°¸ê³  URL / ë©”ëª¨</label>
                                    <input type="text" placeholder="ì¸ìŠ¤íƒ€ ë§í¬ ë“±" value={refNote} onChange={e => setRefNote(e.target.value)} />

                                    {msg && <div className="submit-msg">{msg}</div>}
                                    <button className="main-btn" onClick={handleSubmit}>ìƒë‹´ ì‹ ì²­í•˜ê¸°</button>
                                </div>
                            </>
                        ) : (
                            // === ë‹¥í„° ëª¨ë“œ ===
                            <>
                                <div className="hero-section">
                                    <div className="hero-main">Doctor's Desk</div>
                                    <div className="hero-sub">ëŒ€ê¸° ì¤‘ì¸ ì¼€ì´ìŠ¤: <b>{submissions.length}ê±´</b></div>
                                </div>

                                <div className="card">
                                    <div className="card-title" style={{marginBottom:'15px'}}>ëŒ€ê¸° ë¦¬ìŠ¤íŠ¸</div>
                                    {submissions.length === 0 && <div style={{textAlign:'center', color:'#999'}}>ì ‘ìˆ˜ëœ ìƒë‹´ì´ ì—†ìŠµë‹ˆë‹¤.</div>}
                                    
                                    {submissions.map(c => (
                                        <div key={c.id} 
                                            className={`case-item ${c.status === 'new' ? 'new' : ''} ${selectedCaseId === c.id ? 'selected' : ''}`}
                                            onClick={() => setSelectedCaseId(c.id)}
                                        >
                                            <div className="case-header">
                                                <div className="case-part">{c.part} <span style={{fontSize:'12px', fontWeight:'400', color:'#888'}}>| {c.group}</span></div>
                                                <span className={`badge ${c.status === 'new' ? 'new' : 'done'}`}>
                                                    {c.status === 'new' ? 'NEW' : 'ì™„ë£Œ'}
                                                </span>
                                            </div>
                                            <div style={{fontSize:'13px', color:'#666'}}>{c.concern}</div>
                                        </div>
                                    ))}
                                </div>

                                {selectedCase && (
                                    <div className="card">
                                        <div className="card-title" style={{marginBottom:'10px'}}>{selectedCase.part} ìƒë‹´</div>
                                        <div style={{fontSize:'14px', marginBottom:'15px', color:'#555'}}>
                                            <b>ê³ ë¯¼:</b> {selectedCase.concern}<br/>
                                            <b>ì›í•˜ëŠ” ëŠë‚Œ:</b> {selectedCase.desired || '-'}<br/>
                                            <b>ê°•ë„:</b> {CHANGE_LEVELS.find(l=>l.key===selectedCase.level)?.label || '-'}
                                        </div>

                                        <div className="chat-box clearfix">
                                            {selectedCase.messages.map(m => (
                                                <div key={m.id} className={`bubble ${m.from}`}>
                                                    {m.text}
                                                </div>
                                            ))}
                                        </div>

                                        <label className="label">ë‹¥í„° ë‹µë³€ ì‘ì„±</label>
                                        <textarea value={doctorDraft} onChange={e => setDoctorDraft(e.target.value)} placeholder="ë¶„ì„ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                                        <button className="main-btn" onClick={handleDoctorReply}>ë‹µë³€ ì „ì†¡</button>
                                    </div>
                                )}
                            </>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
